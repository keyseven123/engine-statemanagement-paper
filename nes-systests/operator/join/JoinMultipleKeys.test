# name: join/JoinMultipleKeys.test
# description: Test join operator with multiple join keys
# groups: [WindowOperators, Join]

# Source definitions
SourceCSV stream UINT64 id UINT64 value UINT64 timestamp TESTDATA/small/stream.csv
SourceCSV stream2 UINT64 id2 UINT64 value2 UINT64 timestamp TESTDATA/small/stream2.csv

SINK sinkStreamStream2 UINT64 streamstream2$start UINT64 streamstream2$end UINT64 stream$id UINT64 stream$value UINT64 stream$timestamp UINT64 stream2$id2 UINT64 stream2$value2 UINT64 stream2$timestamp


# Query 1 - Join two streams
SELECT * FROM (SELECT * FROM stream) INNER JOIN (SELECT * FROM stream2) ON (id = id2 AND value = value2) WINDOW TUMBLING (timestamp, size 1 sec) INTO sinkStreamStream2;
----
3000 4000 1 3 3003 1 3 3009
3000 4000 1 3 3003 1 3 3201
21000 22000 1 21 21000 1 21 21000
