# name: join/JoinMultipleKeys.test
# description: Test join operator with multiple join keys
# groups: [WindowOperators, Join]

# Source definitions
SourceCSV stream UINT64 id UINT64 value UINT64 timestamp TESTDATA/small/stream.csv
SourceCSV stream2 UINT64 id2 UINT64 value2 UINT64 timestamp TESTDATA/small/stream2.csv

SINK sinkStreamStream2 UINT64 streamstream2$start UINT64 streamstream2$end UINT64 stream$id UINT64 stream$value UINT64 stream$timestamp UINT64 stream2$id2 UINT64 stream2$value2 UINT64 stream2$timestamp


# Query 1 - Join two streams
SELECT * FROM (SELECT * FROM stream) INNER JOIN (SELECT * FROM stream2) ON (id = id2 AND value = value2) WINDOW TUMBLING (timestamp, size 1 sec) INTO sinkStreamStream2;
----
2000 3000 1 2 2000 1 2 2010
2000 3000 11 2 2001 11 2 2301
3000 4000 1 3 3000 1 3 3009
3000 4000 11 3 3001 11 3 3001
3000 4000 1 3 3003 1 3 3009
3000 4000 1 3 3200 1 3 3009
3000 4000 1 3 3004 1 3 3009
3000 4000 1 3 3005 1 3 3009
3000 4000 1 3 3006 1 3 3009
3000 4000 1 3 3007 1 3 3009
3000 4000 1 3 3008 1 3 3009
3000 4000 1 3 3009 1 3 3009
3000 4000 1 3 3010 1 3 3009
3000 4000 1 3 3011 1 3 3009
3000 4000 1 3 3012 1 3 3009
3000 4000 1 3 3013 1 3 3009
3000 4000 1 3 3014 1 3 3009
3000 4000 1 3 3015 1 3 3009
3000 4000 1 3 3016 1 3 3009
3000 4000 1 3 3017 1 3 3009
3000 4000 1 3 3018 1 3 3009
3000 4000 1 3 3019 1 3 3009
3000 4000 1 3 3020 1 3 3009
3000 4000 1 3 3021 1 3 3009
3000 4000 1 3 3022 1 3 3009
3000 4000 1 3 3023 1 3 3009
3000 4000 1 3 3024 1 3 3009
3000 4000 1 3 3025 1 3 3009
3000 4000 1 3 3026 1 3 3009
3000 4000 1 3 3027 1 3 3009
3000 4000 1 3 3028 1 3 3009
3000 4000 1 3 3029 1 3 3009
3000 4000 1 3 3030 1 3 3009
3000 4000 1 3 3031 1 3 3009
3000 4000 1 3 3032 1 3 3009
3000 4000 1 3 3033 1 3 3009
3000 4000 1 3 3034 1 3 3009
3000 4000 1 3 3035 1 3 3009
3000 4000 1 3 3036 1 3 3009
3000 4000 1 3 3037 1 3 3009
3000 4000 1 3 3038 1 3 3009
3000 4000 1 3 3039 1 3 3009
3000 4000 1 3 3040 1 3 3009
3000 4000 1 3 3041 1 3 3009
3000 4000 1 3 3042 1 3 3009
3000 4000 1 3 3043 1 3 3009
3000 4000 1 3 3044 1 3 3009
3000 4000 1 3 3045 1 3 3009
3000 4000 1 3 3046 1 3 3009
3000 4000 1 3 3047 1 3 3009
3000 4000 1 3 3048 1 3 3009
3000 4000 1 3 3049 1 3 3009
3000 4000 1 3 3050 1 3 3009
3000 4000 1 3 3051 1 3 3009
3000 4000 1 3 3052 1 3 3009
3000 4000 1 3 3053 1 3 3009
3000 4000 1 3 3054 1 3 3009
3000 4000 1 3 3055 1 3 3009
3000 4000 1 3 3056 1 3 3009
3000 4000 1 3 3057 1 3 3009
3000 4000 1 3 3058 1 3 3009
3000 4000 1 3 3059 1 3 3009
3000 4000 1 3 3060 1 3 3009
3000 4000 1 3 3061 1 3 3009
3000 4000 1 3 3062 1 3 3009
3000 4000 1 3 3063 1 3 3009
3000 4000 1 3 3064 1 3 3009
3000 4000 1 3 3065 1 3 3009
3000 4000 1 3 3066 1 3 3009
3000 4000 1 3 3067 1 3 3009
3000 4000 1 3 3068 1 3 3009
3000 4000 1 3 3069 1 3 3009
3000 4000 1 3 3070 1 3 3009
3000 4000 1 3 3071 1 3 3009
3000 4000 1 3 3072 1 3 3009
3000 4000 1 3 3073 1 3 3009
3000 4000 1 3 3074 1 3 3009
3000 4000 1 3 3075 1 3 3009
3000 4000 1 3 3076 1 3 3009
3000 4000 1 3 3077 1 3 3009
3000 4000 1 3 3078 1 3 3009
3000 4000 1 3 3079 1 3 3009
3000 4000 1 3 3080 1 3 3009
4000 5000 1 4 4000 1 4 4001
5000 6000 1 5 5000 1 5 5500
6000 7000 1 6 6000 1 6 6000
7000 8000 1 7 7000 1 7 7000
8000 9000 1 8 8000 1 8 8000
9000 10000 1 9 9000 1 9 9000
10000 11000 1 10 10000 1 10 10000
11000 12000 1 11 11000 1 11 11000
12000 13000 1 12 12000 1 12 12000
13000 14000 1 13 13000 1 13 13000
14000 15000 1 14 14000 1 14 14000
15000 16000 1 15 15000 1 15 15000
16000 17000 1 16 16000 1 16 16000
17000 18000 1 17 17000 1 17 17000
18000 19000 1 18 18000 1 18 18000
19000 20000 1 19 19000 1 19 19000
20000 21000 1 20 20000 1 20 20000
21000 22000 1 21 21000 1 21 21000
22000 23000 1 22 22000 1 22 22000
23000 24000 1 23 23000 1 23 23000
24000 25000 1 24 24000 1 24 24000
25000 26000 1 25 25000 1 25 25000
26000 27000 1 26 26000 1 26 26000
27000 28000 1 27 27000 1 27 27000
28000 29000 1 28 28000 1 28 28000
29000 30000 1 29 29000 1 29 29000
30000 31000 1 30 30000 1 30 30000
31000 32000 1 31 31000 1 31 31000
32000 33000 1 32 32000 1 32 32000
33000 34000 1 33 33000 1 33 33000
34000 35000 1 34 34000 1 34 34000
35000 36000 1 35 35000 1 35 35000
36000 37000 1 36 36000 1 36 36000
37000 38000 1 37 37000 1 37 37000
38000 39000 1 38 38000 1 38 38000
39000 40000 1 39 39000 1 39 39000
40000 41000 1 40 40000 1 40 40000
41000 42000 1 41 41000 1 41 41000
42000 43000 1 42 42000 1 42 42000
43000 44000 1 43 43000 1 43 43000
44000 45000 1 44 44000 1 44 44000
45000 46000 1 45 45000 1 45 45000
46000 47000 1 46 46000 1 46 46000
47000 48000 1 47 47000 1 47 47000
48000 49000 1 48 48000 1 48 48000
49000 50000 1 49 49000 1 49 49000
50000 51000 1 50 50000 1 50 50000
51000 52000 1 51 51000 1 51 51000
52000 53000 1 52 52000 1 52 52000
53000 54000 1 53 53000 1 53 53000
54000 55000 1 54 54000 1 54 54000
55000 56000 1 55 55000 1 55 55000
56000 57000 1 56 56000 1 56 56000
57000 58000 1 57 57000 1 57 57000
58000 59000 1 58 58000 1 58 58000
59000 60000 1 59 59000 1 59 59000
60000 61000 1 60 60000 1 60 60000
61000 62000 1 61 61000 1 61 61000
62000 63000 1 62 62000 1 62 62000
63000 64000 1 63 63000 1 63 63000
64000 65000 1 64 64000 1 64 64000
65000 66000 1 65 65000 1 65 65000
66000 67000 1 66 66000 1 66 66000
67000 68000 1 67 67000 1 67 67000
68000 69000 1 68 68000 1 68 68000
69000 70000 1 69 69000 1 69 69000
70000 71000 1 70 70000 1 70 70000
71000 72000 1 71 71000 1 71 71000
