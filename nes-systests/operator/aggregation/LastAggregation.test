# name: window/LastAggregation.test
# description: Test window aggregations over different data types
# groups: [Aggregation, WindowOperators]


Source stream INT8 i8 INT16 i16 INT32 i32 INT64 i64 UINT8 u8 UINT16 u16 UINT32 u32 UINT64 u64 FLOAT32 f32 FLOAT64 f64 UINT64 ts
1,2,3,4,5,6,7,8,9,10,10
1,2,3,4,5,6,7,8,9,10,11
1,2,3,4,5,6,7,8,9,10,12
1,2,3,4,5,6,7,8,9,10,13
1,2,3,4,5,6,7,8,9,10,14
1,2,3,4,5,6,7,8,9,10,15
1,2,3,4,5,6,7,8,9,10,16
1,2,3,4,5,6,7,8,9,10,17
1,2,3,4,5,6,7,8,9,10,18
1,2,3,4,5,6,7,8,9,10,19
1,2,3,4,5,6,7,8,9,10,110
1,2,3,4,5,6,7,8,9,10,111
1,2,3,4,5,6,7,8,9,10,112
1,2,3,4,5,6,7,8,9,10,113
1,2,3,4,5,6,7,8,9,10,114
1,2,3,4,5,6,7,8,9,10,115
1,2,3,4,5,6,7,8,9,10,116
1,2,3,4,5,6,7,8,9,10,117
1,2,3,4,5,6,7,8,9,10,118
1,2,3,4,5,6,7,8,9,10,119
1,2,3,4,5,6,7,8,9,10,120
1,2,3,4,5,6,7,8,9,10,121
1,2,3,4,5,6,7,8,9,10,122
1,2,3,4,5,6,7,8,9,10,123
1,2,3,4,5,6,7,8,9,10,124
1,2,3,4,5,6,7,8,9,10,125
1,2,3,4,5,6,7,8,9,10,126
1,2,3,4,5,6,7,8,9,10,127
1,2,3,4,5,6,7,8,9,10,128
1,2,3,4,5,6,7,8,9,10,129
1,2,3,4,5,6,7,8,9,10,130
1,2,3,4,5,6,7,8,9,10,131
1,2,3,4,5,6,7,8,9,10,132
1,2,3,4,5,6,7,8,9,10,133
1,2,3,4,5,6,7,8,9,10,134
1,2,3,4,5,6,7,8,9,10,135
1,2,3,4,5,6,7,8,9,10,136
1,2,3,4,5,6,7,8,9,10,137
1,2,3,4,5,6,7,8,9,10,138
1,2,3,4,5,6,7,8,9,10,139
1,2,3,4,5,6,7,8,9,10,140
1,2,3,4,5,6,7,8,9,10,141
1,2,3,4,5,6,7,8,9,10,142
2,3,4,5,6,7,8,9,10,11,148
0,0,0,0,0,0,0,0,0,0,150
-42,-129,-32769,-2147483649,42,256,65536,4294967296,23,23,200
1,1,1,1,1,1,1,1,1,1,250
-42,-129,-32769,-2147483649,42,256,65536,4294967296,23,23,300
1,2,3,4,5,6,7,8,9,10,325
2,3,4,5,6,7,8,9,10,11,350



SINK sinkStream UINT64 stream$start UINT64 stream$end INT8 stream$i8 INT16 stream$i16 INT32 stream$i32 INT64 stream$i64 UINT8 stream$u8 UINT16 stream$u16 UINT32 stream$u32 UINT64 stream$u64 FLOAT32 stream$f32 FLOAT64 stream$f64 UINT64 stream$ts

# Create Tumbling windows over 100 ms and emit only the last received tuple
SELECT LAST(i8), LAST(i16), LAST(i32), LAST(i64), LAST(u8), LAST(u16), LAST(u32), LAST(u64), LAST(f32), LAST(f64),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts),
LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts), LAST(ts)
FROM stream WINDOW TUMBLING(ts, size 100 ms) INTO sinkStream
----
0,100,1,2,3,4,5,6,7,8,9,10,19
100,200,0,0,0,0,0,0,0,0,0,0,150
200,300,1,1,1,1,1,1,1,1,1,1,250
300,400,2,3,4,5,6,7,8,9,10,11,350

SINK textStream UINT64 slow_stream$start UINT64 slow_stream$end VARSIZED slow_stream$text

Source slow_stream VARSIZED text UINT64 ts
Hello,9
World,19
This,29
Is,39
Some,49
Text,59

Source fast_stream VARSIZED text UINT64 ts
H,2
e,4
l,6
l,8
o,10
W,12
o,14
r,16
l,18
d,20
T,22
h,24
i,26
s,29
I,35
I,40
S,42
o,44
m,46
e,48
T,50
e,54
x,56
t,80

SELECT LAST(text)
FROM slow_stream WINDOW TUMBLING(ts, size 10 ms) INTO textStream
----
0,10,Hello
10,20,World
20,30,This
30,40,Is
40,50,Some
50,60,Text

SINK textStream UINT64 fast_stream$start UINT64 fast_stream$end VARSIZED fast_stream$text

SELECT LAST(text)
FROM fast_stream WINDOW TUMBLING(ts, size 10 ms) INTO textStream
----
0,10,l
10,20,l
20,30,s
30,40,I
40,50,e
50,60,x
80,90,t