# name: tuples/TupleOutOfOrder.test
# description: Tests, if we can handle tuples that are out of order at the source.
# groups: [Tuples, Join]

Source stream1 INT8 field_1 UINT64 timestamp
1,10
2,20
3,30
4,40
5,50

Source stream2 INT8 field_2 UINT64 timestamp
2,20
2,25
3,30
3,38
3,25
4,40
4,45
3,35
5,50
5,55
5,52

SINK sinkStream1Stream2 UINT64 stream1stream2$start UINT64 stream1stream2$end INT8 stream1$field_1 UINT64 stream1$timestamp INT8 stream2$field_2 UINT64 stream2$timestamp

# Description: Check, if we drop the out-of-order tuples in a join query
SELECT * FROM (SELECT * FROM stream1) JOIN (SELECT * FROM stream2) ON field_1 = field_2
  WINDOW TUMBLING (timestamp, size 10 ms) INTO sinkStream1Stream2
----
20,30,2,20,2,20
20,30,2,20,2,25
30,40,3,30,3,30
30,40,3,30,3,38
40,50,4,40,4,40
40,50,4,40,4,45
50,60,5,50,5,50
50,60,5,50,5,55