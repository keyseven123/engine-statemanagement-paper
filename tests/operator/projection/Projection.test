# name: map/Map_Add.test
# description: Simple map tests with an add function
# groups: [Projection]

# LLVM LIT configuration
# RUN: sed -e "s@SINK@%sink@g" -e "s@TESTDATA@%testdata@g"< %s > %t &&  rm %tsink || true
# RUN: %client test -f %t -s %worker_address && %result_checker %t %tsink

Source window UINT64 id UINT64 value UINT64 timestamp
1,1,1000
2,1,1001
3,1,1002
4,2,2000
5,19,19000
6,20,20000
7,21,21000

# [id]
SELECT id FROM window INTO SINK
----
1
2
3
4
5
6
7

# [value]
SELECT value FROM window INTO SINK
----
1
1
1
2
19
20
21

# [timestamp]
SELECT timestamp FROM window INTO SINK
----
1000
1001
1002
2000
19000
20000
21000

# [id, value]
SELECT id, value FROM window INTO SINK
----
1,1
2,1
3,1
4,2
5,19
6,20
7,21

# [id, timestamp]
SELECT id, timestamp FROM window INTO SINK
----
1,1000
2,1001
3,1002
4,2000
5,19000
6,20000
7,21000

# [value, timestamp]
SELECT value, timestamp FROM window INTO SINK
----
1,1000
1,1001
1,1002
2,2000
19,19000
20,20000
21,21000

# [id, value, timestamp]
SELECT id, value, timestamp FROM window INTO SINK
----
1,1,1000
2,1,1001
3,1,1002
4,2,2000
5,19,19000
6,20,20000
7,21,21000
