query: |
  SELECT start, end, key, COUNT(key) AS key_count FROM keystrokes GROUP BY key WINDOW TUMBLING(timestamp, size 1 sec) INTO number_keystrokes_per_second;
sink:
  name: number_keystrokes_per_second
  type: File
  config:
    inputFormat: CSV
    filePath: "/tmp/number_of_keystrokes_per_second_per_key.csv"
    append: true

logical:
  - name: keystrokes
    schema:
      - name: key
        type: VARSIZED
      - name: timestamp
        type: UINT64

physical:
  - logical: keystrokes
    parserConfig:
      type: CSV
    sourceConfig:
      type: TCP
      socketDomain: AF_INET
      socketType: SOCK_STREAM
      socketHost: data-generator
      socketPort: 9000
      socketBufferSize: 2
      flushIntervalMS: 100
      connectTimeoutSeconds: 1000
